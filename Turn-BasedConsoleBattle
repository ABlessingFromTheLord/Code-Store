using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Player{
    private int healthPoints = 10;

    //Getter and Setter
    public int getHealthPoints(){
        return this.healthPoints;
    }

    public void setHealthPoints(int value){
        this.healthPoints += value;
        if(this.getHealthPoints() < 0) this.healthPoints = 0;
    }

    //Methods
    public void attacked(int value){
        this.healthPoints += value;
    }

}


public class Battle : MonoBehaviour
{
    //Initial values of the booleans
    bool isPlayerTurn = true;
    bool charged = false;
    bool defendedHuman = false;
    Player human;
    Player ai;

    void reset (){
        isPlayerTurn = true;
        charged = false;
        defendedHuman = false;

    }


    // Start is called before the first frame update
    void Start()
    {
        human = new Player();
        ai = new Player();

        reset();
        Debug.Log("This game is a game played on the console");
        //Getting user input
        Debug.Log("Press 1 to attack, 2 to heal and 3 to defend");
    }

    // Update is called once per frame
    void Update()
    {
        if(human.getHealthPoints() > 0 && ai.getHealthPoints() > 0){
            if(isPlayerTurn){

                //Attacking an opponent
                if(Input.GetKeyDown(KeyCode.Keypad1)){
                    int rnd = Random.Range(1, 3);
                    ai.setHealthPoints(-rnd);
                    Debug.Log("You have dealt enemy "+ rnd + " Damage, " + "Your Health: "+ human.getHealthPoints() + " " + "Opponent's Health: " + ai.getHealthPoints());
                    isPlayerTurn = false;
                }

                //Healing yourself
                if(Input.GetKeyDown(KeyCode.Keypad2)){
                    if(human.getHealthPoints() == 10){
                        Debug.Log("Maximum health healed, Your Health: "+ human.getHealthPoints() + " " + "Opponent's Health: " + ai.getHealthPoints());
                        isPlayerTurn = false;
                        }

                    if(human.getHealthPoints() == 9){
                        human.setHealthPoints(1);
                        Debug.Log("Maximum health healed, Your Health: "+ human.getHealthPoints() + " " + "Opponent's Health: " + ai.getHealthPoints());
                        isPlayerTurn = false;
                        }

                    if(human.getHealthPoints() <= 8){
                        human.setHealthPoints(2);
                        Debug.Log("Healed by 2 Health Points, Your Health: "+ human.getHealthPoints() + " " + "Opponent's Health: " + ai.getHealthPoints());
                        isPlayerTurn = false;
                    }
                }

                //Defending yourself
                if(Input.GetKeyDown(KeyCode.Keypad3)){
                    defendedHuman = true;
                    isPlayerTurn = false;
                }

            }

            else if(!isPlayerTurn){
                //Its AIs turn to play
                int action = Random.Range(1, 101);

                //When charged
                if(charged){
                    if(defendedHuman){
                        //Charged attack against a defended human player
                        Debug.Log("You have succesfully thwarthed a powerful enemy attack");
                        charged = false;
                        defendedHuman = false;
                        isPlayerTurn = true;
                    }

                    else{
                        //Charged attack against an undefended human player
                        int playerDamage = human.getHealthPoints();
                        human.setHealthPoints(-playerDamage);
                        Debug.Log("Opponent has dealt you "+ playerDamage + " Damage, " +"Your Health: "+ human.getHealthPoints() + " " + "Opponent's Health: " + ai.getHealthPoints());
                        charged = false;
                        isPlayerTurn = true;
                    }

                }

                else if(action > 35){
                    //Attacking human player
                    //Normal attack against a defended human
                        if(defendedHuman){
                            Debug.Log("You have succesfully thwarthed an enemy attack");
                            defendedHuman = false;
                            isPlayerTurn = true;
                        }

                    //Normal attack against an undefended human
                        else{
                            int playerDamage = Random.Range(2, 5);
                            human.setHealthPoints(-playerDamage);
                            Debug.Log("Opponent has dealt you "+ playerDamage + " Damage, " + "Your Health: "+ human.getHealthPoints() + " " + "Opponent's Health: " + ai.getHealthPoints());
                            isPlayerTurn = true;
                        }
                }

                else if(action <= 35){
                    //Enemy is charging
                    Debug.Log("Warning: Opponent is charging");
                    charged = true;
                    isPlayerTurn = true;
                }
            }

        }

        else if(human.getHealthPoints() <= 0 || ai.getHealthPoints() <= 0){
            if(human.getHealthPoints() <= 0){
                Debug.Log("Opponent won XC, Game Over! Press 1 to restart");
                
                if(Input.GetKeyDown(KeyCode.Keypad1)){
                    Start();
                }

            }

            if(ai.getHealthPoints() <= 0){
                Debug.Log("Congratulations, you won! Press 1 to restart");
                
                if(Input.GetKeyDown(KeyCode.Keypad1)){
                    Start();
                }
            }
        }
        
    }
}
